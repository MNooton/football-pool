<p class="sectionTitle">{{ week.name }}</p>
@if (week.id <= actualWeekId) {
  <mat-expansion-panel class="week-standings-panel">
  <mat-expansion-panel-header>
    <div class="week-standings-header">
        Click here to see the standings at the start of Week {{ week.id }}
      </mat-panel-title>
    </mat-expansion-panel-header>

    <app-standings
      [standings]="standingsAtWeekStart"
      [readonly]="true">
    </app-standings>
  </mat-expansion-panel>
}
<div class="games-grid">
  <div class="flex-container">
  @for (game of games; track game) {
    <mat-card class="game-card mat-elevation-z4">
      <mat-card-header>
        <mat-card-title>Game {{ game.id }} â€“ {{ game.date }}</mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <div class="teams-row">
          <!-- Away team -->
          <div id="visitor" class="team-column" [ngClass]="{ winningTeam: game.winningTeamId === game.awayTeam.id }">
            <div class="team-info">
              <button
                mat-button matRipple 
                [disabled]="disablePickButton(game)"
                (click)="pick(game.id, game.awayTeam.id)"
                [ngClass]="{ myPick: game.myPick == game.awayTeam.id }"
                class="team-button"
              >
                <img
                  class="team-logo"
                  [src]="game.awayTeam.imageUrl"
                  alt="{{ game.awayTeam.name }}"
                />
              </button>
              <p class="team-name">{{ game.awayTeam.name }}</p>
            </div>
            <div class="team-score-wrapper">
              <p class="team-points">{{ game.awayTeam.points }}</p>
              <div class="spread-badge">
                {{ game.awayTeam.spread }}
              </div>
            </div>
          </div>

          <!-- VS -->
          <div class="vs"> @ </div>

          <!-- Home team -->
          <div
            class="team-column"
            [ngClass]="{ winningTeam: game.winningTeamId === game.homeTeam.id }"
          >
            <button
              mat-button
              [disabled]="disablePickButton(game)"
              (click)="pick(game.id, game.homeTeam.id)"
              [ngClass]="{ myPick: game.myPick == game.homeTeam.id }"
              class="team-button"
            >
              <img
                class="team-logo"
                [src]="game.homeTeam.imageUrl"
                alt="{{ game.homeTeam.name }}"
              />
            </button>
            <p class="team-name">{{ game.homeTeam.name }}</p>
            <p class="team-points">{{ game.homeTeam.points }}</p>
          </div>
        </div>

        <mat-divider></mat-divider>

        <p class="sectionTitle">Picks</p>

        <mat-list>
          @for (pick of game.picks; track pick) {
            <mat-list-item>
              <div class="pick-item">
                <span class="pick-name">{{ pick.name }}</span>
                <img
                  class="pick-avatar"
                  [src]="pick.imageUrl"
                  alt="{{ pick.name }}"
                />

                @if (pick.isPlayed && pick.status === 'W') {
                  <mat-icon class="pick-icon" color="primary">check_circle</mat-icon>
                }
                @if (pick.isPlayed && pick.status === 'L') {
                  <mat-icon class="pick-icon" color="warn">cancel</mat-icon>
                }
                @if (pick.isPlayed && pick.status === 'T') {
                  <mat-icon class="pick-icon">minimize</mat-icon>
                }
              </div>
            </mat-list-item>
          }
          @if (game.picks?.length === 0) {
            <mat-list-item>
              <p class="no-picks">No Picks Yet.</p>
            </mat-list-item>
          }
        </mat-list>
      </mat-card-content>
    </mat-card>
  }
  </div>
</div>
